!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("angularx-social-login",["exports","@angular/core","rxjs","@angular/common"],e):e((t=t||self)["angularx-social-login"]={},t.ng.core,t.rxjs,t.ng.common)}(this,(function(t,e,n,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function u(t,e,n,i){var o,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(r<3?o(a):r>3?o(e,n,a):o(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}var c=function(t){this.lazyLoad=!1,this.providers=new Map;for(var e=0;e<t.length;e++){var n=t[e];this.providers.set(n.id,n.provider),this.lazyLoad=this.lazyLoad||n.lazyLoad}},s=function(){function t(t){this._user=null,this._authState=new n.ReplaySubject(1),this._readyState=new n.BehaviorSubject([]),this.initialized=!1,this.providers=t.providers,t.lazyLoad||this.initialize()}var i;return i=t,Object.defineProperty(t.prototype,"authState",{get:function(){return this._authState.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._readyState.asObservable()},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var t=this;this.initialized=!0,this.providers.forEach((function(e,n){e.initialize().then((function(){var i=t._readyState.getValue();i.push(n),t._readyState.next(i),e.getLoginStatus().then((function(e){e.provider=n,t._user=e,t._authState.next(e)})).catch((function(e){t._authState.next(null)}))}))}))},t.prototype.signIn=function(t,e){var n=this;return this.initialized||this.initialize(),new Promise((function(o,r){var a=n.providers.get(t);a?a.signIn(e).then((function(e){e.provider=t,o(e),n._user=e,n._authState.next(e)})).catch((function(t){r(t)})):r(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}))},t.prototype.signOut=function(t){var e=this;return void 0===t&&(t=!1),this.initialized||this.initialize(),new Promise((function(n,o){if(e._user){var r=e._user.provider,a=e.providers.get(r);a?a.signOut(t).then((function(){n(),e._user=null,e._authState.next(null)})).catch((function(t){o(t)})):o(i.ERR_LOGIN_PROVIDER_NOT_FOUND)}else o(i.ERR_NOT_LOGGED_IN)}))},t.ERR_LOGIN_PROVIDER_NOT_FOUND="Login provider not found",t.ERR_NOT_LOGGED_IN="Not logged in",t.ctorParameters=function(){return[{type:c}]},t=i=u([e.Injectable()],t)}();var l=function(){function t(){}var n;return n=t,t.initialize=function(t){return{ngModule:n,providers:[s,{provide:c,useValue:t}]}},t=n=u([e.NgModule({imports:[i.CommonModule],providers:[s]})],t)}(),f=function(){},p=function(){function t(){this._readyState=new n.BehaviorSubject(!1)}return t.prototype.onReady=function(){var t=this;return new Promise((function(e,n){t._readyState.subscribe((function(t){t&&e()}))}))},t.prototype.loadScript=function(t,e,n,i,o){if(void 0===i&&(i=!0),void 0===o&&(o=""),"undefined"!=typeof document&&!document.getElementById(t)){var r=document.createElement("script");r.async=i,r.src=e,r.onload=n,document.head.appendChild(r)}},t}(),d=function(t){function e(e,n){void 0===n&&(n={scope:"email"});var i=t.call(this)||this;return i.clientId=e,i.opt=n,i}return r(e,t),e.prototype.initialize=function(){var t=this;return new Promise((function(n,i){t.loadScript(e.PROVIDER_ID,"https://apis.google.com/js/platform.js",(function(){gapi.load("auth2",(function(){t.auth2=gapi.auth2.init(a({},t.opt,{client_id:t.clientId})),t.auth2.then((function(){t._readyState.next(!0),n()})).catch((function(t){i(t)}))}))}))}))},e.prototype.getLoginStatus=function(){var t=this;return new Promise((function(e,n){t.onReady().then((function(){if(t.auth2.isSignedIn.get()){var i=new f;e(i)}else n("No user is currently logged in.")}))}))},e.prototype.signIn=function(t){var e=this;return new Promise((function(n,i){e.onReady().then((function(){(t&&t.offline_access||e.opt&&e.opt.offline_access?e.auth2.grantOfflineAccess(t):e.auth2.signIn(t)).then((function(t){var i=new f;if(t&&t.code)i.authorizationCode=t.code;else{var o=e.auth2.currentUser.get().getBasicProfile(),r=e.auth2.currentUser.get().getAuthResponse(!0).access_token,a=e.auth2.currentUser.get().getAuthResponse(!0).id_token;i.id=o.getId(),i.name=o.getName(),i.email=o.getEmail(),i.photoUrl=o.getImageUrl(),i.firstName=o.getGivenName(),i.lastName=o.getFamilyName(),i.authToken=r,i.idToken=a}n(i)}),(function(t){i("User cancelled login or did not fully authorize.")})).catch((function(t){i(t)}))}))}))},e.prototype.signOut=function(t){var e=this;return new Promise((function(n,i){e.onReady().then((function(){(t?e.auth2.disconnect():e.auth2.signOut()).then((function(t){t?i(t):n()})).catch((function(t){i(t)}))}))}))},e.PROVIDER_ID="GOOGLE",e}(p),h=function(t){function e(e,n,i,o,r){void 0===n&&(n={scope:"email,public_profile"}),void 0===i&&(i="en_US"),void 0===o&&(o="name,email,picture,first_name,last_name"),void 0===r&&(r="v4.0");var a=t.call(this)||this;return a.clientId=e,a.opt=n,a.locale=i,a.fields=o,a.version=r,a}return r(e,t),e.prototype.initialize=function(){var t=this;return new Promise((function(n,i){t.loadScript(e.PROVIDER_ID,"//connect.facebook.net/"+t.locale+"/sdk.js",(function(){FB.init({appId:t.clientId,autoLogAppEvents:!0,cookie:!0,xfbml:!0,version:t.version}),t._readyState.next(!0),n()}))}))},e.prototype.getLoginStatus=function(){var t=this;return new Promise((function(e,n){t.onReady().then((function(){FB.getLoginStatus((function(i){if("connected"===i.status){var o=i.authResponse;FB.api("/me?fields="+t.fields,(function(t){var n=new f;n.id=t.id,n.name=t.name,n.email=t.email,n.photoUrl="https://graph.facebook.com/"+t.id+"/picture?type=normal",n.firstName=t.first_name,n.lastName=t.last_name,n.authToken=o.accessToken,n.facebook=t,e(n)}))}else n("No user is currently logged in.")}))}))}))},e.prototype.signIn=function(t){var e=this;return new Promise((function(t,n){e.onReady().then((function(){FB.login((function(i){if(i.authResponse){var o=i.authResponse;FB.api("/me?fields="+e.fields,(function(e){var n=new f;n.id=e.id,n.name=e.name,n.email=e.email,n.photoUrl="https://graph.facebook.com/"+e.id+"/picture?type=normal",n.firstName=e.first_name,n.lastName=e.last_name,n.authToken=o.accessToken,n.facebook=e,t(n)}))}else n("User cancelled login or did not fully authorize.")}),e.opt)}))}))},e.prototype.signOut=function(){var t=this;return new Promise((function(e,n){t.onReady().then((function(){FB.logout((function(t){e()}))}))}))},e.PROVIDER_ID="FACEBOOK",e}(p);t.AuthService=s,t.AuthServiceConfig=c,t.FacebookLoginProvider=h,t.GoogleLoginProvider=d,t.SocialLoginModule=l,t.SocialUser=f,t.Éµa=p,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angularx-social-login.umd.min.js.map